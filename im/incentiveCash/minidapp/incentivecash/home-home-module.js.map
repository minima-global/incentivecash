{"version":3,"sources":["./src/app/home/home-routing.module.ts","./src/app/home/home.page.html","./src/app/home/home.module.ts","./src/app/home/home.page.scss","./src/app/home/home.page.ts"],"names":[],"mappings":"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","file":"home-home-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HomePageRoutingModule {}\n","export default \"<ion-header class=\\\"ion-no-border\\\" [translucent]=\\\"true\\\">\\n  <ion-toolbar>\\n    <ion-title>\\n      <ion-grid class=\\\"ion-no-padding\\\">\\n        <ion-row>\\n          <ion-col class=\\\"ion-no-padding ion-align-self-center ion-text-left\\\">\\n            <ion-icon class=\\\"icon ion-align-self-center\\\" src=\\\"assets/icon/minima-logo-landscape-dark.svg\\\"></ion-icon>\\n          </ion-col>\\n          <ion-col class=\\\"ion-no-padding ion-text-right\\\">\\n            Incentive Cash\\n          </ion-col>\\n        </ion-row>\\n      </ion-grid>\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <ion-header collapse=\\\"condense\\\">\\n    <ion-toolbar>\\n      <ion-title size=\\\"large\\\">Blank</ion-title>\\n    </ion-toolbar>\\n  </ion-header>\\n\\n  <form [formGroup]=\\\"loginForm\\\" (ngSubmit)=\\\"getReferenceID()\\\" >\\n    <ion-list>\\n      <ion-item class=\\\"ion-no-padding\\\" lines=\\\"none\\\">\\n        <ion-label position=\\\"stacked\\\">Username/Email</ion-label>\\n        <ion-input placeholder=\\\"Enter a valid username or email\\\" clearInput=\\\"true\\\" formControlName=\\\"uName\\\"></ion-input>\\n      </ion-item>\\n      <ion-item class=\\\"ion-no-padding\\\" lines=\\\"none\\\">\\n        <ion-label position=\\\"stacked\\\">Password</ion-label>\\n        <ion-input placeholder=\\\"Enter your password\\\" clearInput=\\\"true\\\" formControlName=\\\"password\\\" type=\\\"password\\\"></ion-input>\\n      </ion-item>\\n\\n      <ion-item lines=\\\"none\\\" class=\\\"no-ripple ion-no-padding\\\">\\n        <ion-button #getReferenceButton class=\\\"sign-up-btn\\\" slot=\\\"end\\\" fill=\\\"clear\\\" type=\\\"submit\\\">\\n          Get Reference ID\\n        </ion-button>\\n      </ion-item>\\n      <ion-item [hidden]=\\\"loginStatus.length === 0\\\" class=\\\"login-status\\\" lines=\\\"none\\\">\\n        <ion-note slot=\\\"end\\\">{{ loginStatus }}</ion-note>\\n      </ion-item>\\n\\n      <p class=\\\"notes\\\">\\n        Welcome to <span>the Incentive Cash MiniDapp.</span>\\n      </p>\\n      <p class=\\\"notes\\\">\\n        If you have already signed up for incentive cash, please login with your username & password.\\n      </p>\\n      <p class=\\\"notes\\\">\\n        Otherwise, click <a>here</a> to register now!\\n      </p>\\n    </ion-list>\\n  </form> \\n\\n</ion-content>\\n\\n<ion-footer class=\\\"ion-no-border\\\">\\n  <ion-toolbar>\\n    <ion-title>\\n\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-footer>\\n\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { HomePage } from './home.page';\nimport { HomePageRoutingModule } from './home-routing.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    HomePageRoutingModule\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","export default \"ion-list {\\n  background-color: transparent;\\n  background: #f0f0fa;\\n}\\n\\nion-item ion-label {\\n  margin-bottom: 7px;\\n  font-size: 16px;\\n  font-family: manrope-bold;\\n}\\n\\nion-input {\\n  font-size: 12px;\\n  color: #000;\\n  background-color: #fff;\\n  border: 1px solid #f0f0fa;\\n  padding-left: 2% !important;\\n}\\n\\nion-item.login-status ion-note {\\n  font-family: manrope-medium;\\n  padding: 0;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2hvbWUucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0VBQ0UsNkJBQUE7RUFDQSxtQkFBQTtBQUFGOztBQUVBO0VBQ0Usa0JBQUE7RUFDQSxlQUFBO0VBQ0EseUJBQUE7QUFDRjs7QUFDQTtFQUNFLGVBQUE7RUFDQSxXQUFBO0VBQ0Esc0JBQUE7RUFDQSx5QkFBQTtFQUNBLDJCQUFBO0FBRUY7O0FBQUE7RUFDRSwyQkFBQTtFQUNBLFVBQUE7QUFHRiIsImZpbGUiOiJob21lLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW9uLWxpc3Qge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgYmFja2dyb3VuZDogI2YwZjBmYTtcbn1cbmlvbi1pdGVtIGlvbi1sYWJlbCB7XG4gIG1hcmdpbi1ib3R0b206IDdweDtcbiAgZm9udC1zaXplOiAxNnB4O1xuICBmb250LWZhbWlseTogbWFucm9wZS1ib2xkO1xufVxuaW9uLWlucHV0IHtcbiAgZm9udC1zaXplOiAxMnB4O1xuICBjb2xvcjogIzAwMDtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcbiAgYm9yZGVyOiAxcHggc29saWQgI2YwZjBmYTtcbiAgcGFkZGluZy1sZWZ0OiAyJSAhaW1wb3J0YW50O1xufVxuaW9uLWl0ZW0ubG9naW4tc3RhdHVzIGlvbi1ub3RlIHtcbiAgZm9udC1mYW1pbHk6IG1hbnJvcGUtbWVkaXVtO1xuICBwYWRkaW5nOiAwO1xufSJdfQ== */\";","import { StoreService, UserDetails } from './../api/store.service';\nimport { Component, ViewChild } from '@angular/core';\nimport { FormBuilder, FormGroup } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { Minima } from 'minima';\nimport { IonButton } from '@ionic/angular';\nimport { SlowBuffer } from 'buffer';\n\ninterface User {\n  email: string\n  password: string\n}\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\n\nexport class HomePage  {\n\n  @ViewChild('getReferenceButton', {static: false}) getReferenceButton: IonButton;\n\n  public loginForm: FormGroup;\n  loginStatus = '';\n\n  constructor(\n    public formBuilder: FormBuilder,\n    private router: Router,\n    private _storeService: StoreService) {}\n\n  ngOnInit() {\n    this.loginForm = this.formBuilder.group({\n      uName: '',\n      password: '',\n      pKey: ''\n    });\n  }\n\n  getReferenceID() {\n    const user = {\n      email: this.username.value, \n      password: this.password.value\n    };\n    this.loginStatus = 'Logging in...';\n    this.getReferenceButton.disabled = true;\n    this.login(user);\n  }\n\n  getPubKey() {\n    this._storeService.getUserDetailsOnce().then((user: UserDetails) => {\n      const data = {\n        userid: user.refID\n      }\n      const url = 'https://incentivedb.minima.global/custom/utils/getKey';\n      fetch(url, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer `+user.loginData.access_token\n        },\n        body: JSON.stringify(data)\n      })\n      .then(response => {\n        if (!response.ok) {\n          this.loginStatus = 'Login failed!  Public key not found!';\n          const statusText = response.statusText;\n          return response.json()\n          .then((data) => {\n            throw new Error(statusText)\n          })\n        }\n        return response.json()\n      })\n      .then(data => {\n        // check if current key exists on server\n        if (data.publickeys && data.publickeys.length === 0) {\n          // post a new key\n          this.postAKey(user.refID);\n        } else {\n          // check current keys with remote keys to find a match\n          let nodeKeys = [];\n          let serverKeys = data.publickeys;\n\n          Minima.cmd('keys', (res: any) => {\n            if (res.status) {\n              // console.log(res);\n              res.response.publickeys.forEach(element => {\n                nodeKeys.push(element);\n              });\n            }\n            // matching keys found\n            const intersection = nodeKeys.filter(element => serverKeys.includes(element.publickey));\n            if (intersection.length === 0) {\n              this.postAKey(user.refID);\n            } else {\n              this.loginStatus = 'Login successful!';\n              this.router.navigate(['/cash']);\n              let temp = user;\n              temp.pKey = intersection[0].publickey;\n              this._storeService.data.next(temp);\n            }\n          });\n        }\n      })\n    });\n  }\n\n  postAKey(uid: string) {\n    const url = 'https://incentivedb.minima.global/custom/minima/key';\n    Minima.cmd('keys new', (response: any) => {\n      if (response.status) {\n        const data = {\n          userid: uid,\n          publickey: response.response.key.publickey\n        }\n        fetch(url, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(data)\n        })\n        .then(res => {\n          if (!res.ok) {\n            this.loginStatus = 'Login failed!  Public key not found!';\n            const statusText = response.statusText;\n            return res.json()\n            .then((data) => {\n              throw new Error(statusText);\n            })\n          }\n          return res.json()\n        })\n        .then(data => {\n          this.loginStatus = 'Login successful!';\n          this.router.navigate(['/cash']);\n          this._storeService.getUserDetailsOnce().then((user: UserDetails) => {\n            //console.log('Stored new pubkey');\n            let temp = user;\n            temp.pKey = response.response.key.publickey;\n            this._storeService.data.next(temp);\n          });\n        })\n        .catch(error => {\n          alert(error);\n        })\n      }\n    });\n  }\n\n  login(user: User) {\n    const url = 'https://incentivedb.minima.global/auth/login';\n    fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(user)\n    }).then((res: any) => {\n      if (!res.ok) {\n        this.loginStatus = 'Login failed, please check your username and password.';\n        this.getReferenceButton.disabled = false;\n\n        let statusText = res.statusText;\n        return res.json()\n        .then((data) => {\n          throw new Error(statusText)\n        })\n      }\n      return res.json()\n    })\n    .then(data => {\n      this.loginStatus = 'Authenticated!  Checking public key...';\n      // accessToken\n      const token = {\n        accessToken: data.data.access_token,\n        refreshToken: data.data.refresh_token,\n        info: {}\n      }\n      const url = 'https://incentivedb.minima.global/users/me?access_token='+token.accessToken+'';\n      Minima.net.GET(url, (res: any) => {\n        let plainResponse = decodeURIComponent(res.result);\n        let data = JSON.parse(plainResponse);\n        \n        let user: UserDetails = {\n          email: this.username.value,\n          pKey: '',\n          refID: data.data.id,\n          loginData: {\n            access_token: token.accessToken,\n            refresh_token: token.refreshToken\n          }\n        }\n        this._storeService.data.next(user);\n      });\n      this.getPubKey();\n\n    })\n    .catch(error => {\n      alert(error);\n    })\n  .catch(error => {\n    alert(error);\n  })\n\n  this.getReferenceButton.disabled = false;\n  this.loginStatus = '';\n  //this.loginForm.reset();\n  }\n\n  get username() {\n    return this.loginForm.get('uName');\n  }\n  get password() {\n    return this.loginForm.get('password');\n  }\n  get publickey() {\n    return this.loginForm.get('pKey');\n  }\n\n}\n"],"sourceRoot":"webpack:///"}