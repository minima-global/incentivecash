{"version":3,"sources":["./src/app/home/home-routing.module.ts","./src/app/home/home.page.html","./src/app/home/home.module.ts","./src/app/home/home.page.scss","./src/app/home/home.page.ts"],"names":[],"mappings":"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","file":"home-home-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class HomePageRoutingModule {}\n","export default \"<ion-header class=\\\"ion-no-border\\\" [translucent]=\\\"true\\\">\\n  <ion-toolbar>\\n    <ion-title>\\n      <ion-grid class=\\\"ion-no-padding\\\">\\n        <ion-row>\\n          <ion-col class=\\\"ion-no-padding ion-align-self-center ion-text-left\\\">\\n            <ion-icon class=\\\"icon ion-align-self-center\\\" src=\\\"assets/icon/minima-logo-landscape-dark.svg\\\"></ion-icon>\\n          </ion-col>\\n          <ion-col class=\\\"ion-no-padding ion-text-right\\\">\\n            Incentive Cash\\n          </ion-col>\\n        </ion-row>\\n      </ion-grid>\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <ion-header collapse=\\\"condense\\\">\\n    <ion-toolbar>\\n      <ion-title size=\\\"large\\\">Blank</ion-title>\\n    </ion-toolbar>\\n  </ion-header>\\n\\n  <form [formGroup]=\\\"loginForm\\\" (ngSubmit)=\\\"getReferenceID()\\\" >\\n    <ion-list>\\n      <ion-item class=\\\"ion-no-padding\\\" lines=\\\"none\\\">\\n        <ion-label position=\\\"stacked\\\">Username/Email</ion-label>\\n        <ion-input placeholder=\\\"Enter a valid username or email\\\" clearInput=\\\"true\\\" formControlName=\\\"uName\\\"></ion-input>\\n      </ion-item>\\n      <ion-item class=\\\"ion-no-padding\\\" lines=\\\"none\\\">\\n        <ion-label position=\\\"stacked\\\">Password</ion-label>\\n        <ion-input placeholder=\\\"Enter your password\\\" clearInput=\\\"true\\\" formControlName=\\\"password\\\" type=\\\"password\\\"></ion-input>\\n      </ion-item>\\n\\n      <ion-item lines=\\\"none\\\" class=\\\"no-ripple ion-no-padding\\\">\\n        <ion-button #getReferenceButton class=\\\"sign-up-btn\\\" slot=\\\"end\\\" fill=\\\"clear\\\" type=\\\"submit\\\">\\n          Get Reference ID\\n        </ion-button>\\n      </ion-item>\\n      <ion-item [hidden]=\\\"loginStatus.length === 0\\\" class=\\\"login-status\\\" lines=\\\"none\\\">\\n        <ion-note slot=\\\"end\\\">{{ loginStatus }}</ion-note>\\n      </ion-item>\\n\\n      <p class=\\\"notes\\\">\\n        Welcome to <span>the Incentive Cash MiniDapp.</span>\\n      </p>\\n      <p class=\\\"notes\\\">\\n        If you have already signed up for incentive cash, please login with your username & password.\\n      </p>\\n      <p class=\\\"notes\\\">\\n        Otherwise, click <a>here</a> to register now!\\n      </p>\\n    </ion-list>\\n  </form> \\n\\n</ion-content>\\n\\n<ion-footer class=\\\"ion-no-border\\\">\\n  <ion-toolbar>\\n    <ion-title>\\n\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-footer>\\n\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { HomePage } from './home.page';\nimport { HomePageRoutingModule } from './home-routing.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    HomePageRoutingModule\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","export default \"ion-list {\\n  background-color: transparent;\\n  background: #f0f0fa;\\n}\\n\\nion-item ion-label {\\n  margin-bottom: 7px;\\n  font-size: 16px;\\n  font-family: manrope-bold;\\n}\\n\\nion-input {\\n  font-size: 12px;\\n  color: #000;\\n  background-color: #fff;\\n  border: 1px solid #f0f0fa;\\n  padding-left: 2% !important;\\n}\\n\\nion-item.login-status ion-note {\\n  font-family: manrope-medium;\\n  padding: 0;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2hvbWUucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBO0VBQ0UsNkJBQUE7RUFDQSxtQkFBQTtBQUFGOztBQUVBO0VBQ0Usa0JBQUE7RUFDQSxlQUFBO0VBQ0EseUJBQUE7QUFDRjs7QUFDQTtFQUNFLGVBQUE7RUFDQSxXQUFBO0VBQ0Esc0JBQUE7RUFDQSx5QkFBQTtFQUNBLDJCQUFBO0FBRUY7O0FBQUE7RUFDRSwyQkFBQTtFQUNBLFVBQUE7QUFHRiIsImZpbGUiOiJob21lLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW9uLWxpc3Qge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbiAgYmFja2dyb3VuZDogI2YwZjBmYTtcbn1cbmlvbi1pdGVtIGlvbi1sYWJlbCB7XG4gIG1hcmdpbi1ib3R0b206IDdweDtcbiAgZm9udC1zaXplOiAxNnB4O1xuICBmb250LWZhbWlseTogbWFucm9wZS1ib2xkO1xufVxuaW9uLWlucHV0IHtcbiAgZm9udC1zaXplOiAxMnB4O1xuICBjb2xvcjogIzAwMDtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcbiAgYm9yZGVyOiAxcHggc29saWQgI2YwZjBmYTtcbiAgcGFkZGluZy1sZWZ0OiAyJSAhaW1wb3J0YW50O1xufVxuaW9uLWl0ZW0ubG9naW4tc3RhdHVzIGlvbi1ub3RlIHtcbiAgZm9udC1mYW1pbHk6IG1hbnJvcGUtbWVkaXVtO1xuICBwYWRkaW5nOiAwO1xufSJdfQ== */\";","import { StoreService, UserDetails } from './../api/store.service';\nimport { Component, ElementRef, ViewChild } from '@angular/core';\nimport { FormBuilder, FormGroup } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { Minima } from 'minima';\nimport { IonButton } from '@ionic/angular';\n\ninterface User {\n  email: string\n  password: string\n}\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\n\nexport class HomePage  {\n\n  @ViewChild('getReferenceButton', {static: false}) getReferenceButton: IonButton;\n\n  public loginForm: FormGroup;\n  loginStatus = '';\n\n  constructor(\n    public formBuilder: FormBuilder,\n    private router: Router,\n    private _storeService: StoreService) {}\n\n  ngOnInit() {\n    this.loginForm = this.formBuilder.group({\n      uName: '',\n      password: '',\n      pKey: ''\n    });\n  }\n\n  getReferenceID() {\n    const user = {\n      email: this.username.value, \n      password: this.password.value\n    };\n    this.login(user);\n  }\n\n  login(user: User) {\n    this.loginStatus = 'Logging in...';\n    this.getReferenceButton.disabled = true;\n    const url = 'https://incentivedb.minima.global/auth/login';\n    fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(user)\n    }).then((res: any) => {\n      if (!res.ok) {\n        this.loginStatus = 'Login failed, please check your username and password.';\n        this.getReferenceButton.disabled = false;\n        const status = res.status;\n        const statusText = res.statusText;\n        return res.json()\n        .then((data) => {\n          console.log(data);\n          const txData = {\n            code: status.toString(),\n            summary: statusText,\n            time: Date.now()\n          }\n          throw new Error(statusText)\n        })\n      }\n      return res.json();\n    })\n    .then(data => {\n      this.loginStatus = 'Login successful!';\n      console.log(data);\n      const txData = {\n        code: \"200\",\n        summary: data,\n        time: Date.now()\n      }\n      const userData = {\n        accessToken: data.data.access_token,\n        refreshToken: data.data.refresh_token,\n        info: {}\n      }\n\n      Minima.cmd('keys new', (res: any) => {\n        if(res.status) {\n          const username = this.username.value;\n          const publicKey = res.response.key.publickey;\n          const refID = '';\n          const url = 'https://incentivedb.minima.global/items/directus_users?filter={ \"email\": { \"_eq\": \"'+username+'\" }}?access_token='+userData.accessToken+'';\n          const url2 = 'https://incentivedb.minima.global/users/me?access_token='+userData.accessToken+'';\n          Minima.net.GET(url2, (res: any) => {\n            let plainResponse = decodeURIComponent(res.result)\n            console.log(plainResponse);\n          });\n  \n          // Minima.file.save(JSON.stringify(userDetails), 'userDetails.txt', (res: any) => {\n          //   if (res.success) {  \n          //     this._storeService.data.next(userDetails);\n          //     this.router.navigate(['/cash', userDetails.refID]);\n      \n          //   } else {\n          //     console.log('Failed to save reference id.');\n          //   }\n          // });\n        }\n        this.getReferenceButton.disabled = false;\n      });\n    })\n    .catch(error => {\n      alert(error);\n   })\n  }\n\n  get username() {\n    return this.loginForm.get('uName');\n  }\n  get password() {\n    return this.loginForm.get('password');\n  }\n  get publickey() {\n    return this.loginForm.get('pKey');\n  }\n\n}\n"],"sourceRoot":"webpack:///"}